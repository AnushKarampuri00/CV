---
title: "Violin Plots: How to Create Them and What They Tell You"
author: "Anush Karampuri"
date: "2026-02-18"
categories: [data-visualization, statistics, python, R, bioinformatics]
description: "A practical guide to creating violin plots in Python and R, with a focus on how to read and interpret the distributions they reveal."
---

## What Is a Violin Plot?

A **violin plot** is a statistical visualization that combines a box plot with a kernel density estimate (KDE). Where a box plot shows you five summary statistics (minimum, Q1, median, Q3, maximum), a violin plot shows you the entire distribution of the data — the full shape of where values are concentrated.

The name comes from the shape: when a distribution is roughly symmetric, the plot looks like a violin. The wider sections of the "violin" indicate where more data points are clustered; the narrower sections indicate fewer data points.

**Why use a violin plot instead of a box plot?**

Box plots are compact and great for comparing medians and quartiles, but they hide the shape of the distribution. A violin plot reveals:

- Whether a distribution is unimodal (one peak) or bimodal (two peaks)
- How skewed the data is
- Where the bulk of values are concentrated
- Outliers and heavy tails

---

## Anatomy of a Violin Plot

Before creating one, it helps to understand every component:

```
     ╭──╮          ← Upper tail / maximum density region
    ╭╯  ╰╮
   ╭╯    ╰╮        ← Wide section = many values here
  ╭╯      ╰╮
 ╭╯        ╰╮
╭╯          ╰╮     ← Widest point = mode (most common value)
╰╮          ╭╯
 ╰╮        ╭╯
  ╰╮      ╭╯       ← Narrow section = fewer values here
   ╰╮    ╭╯
    ╰╮  ╭╯
     ╰──╯          ← Lower tail / minimum density region

       │            ← White dot = median
    ───┼───         ← Thick black bar = IQR (25th–75th percentile)
       │            ← Thin line = extends to 1.5 × IQR (whiskers)
```

![Anatomy of a violin plot with labeled components: minimum, Q1, median, Q3, maximum, IQR box, and density width.](violin_plot.png){fig-alt="Annotated violin plot showing a bimodal orange violin with arrows pointing to minimum (Q0), first quartile (Q1), median (Q2, white dot), third quartile (Q3), maximum (Q4), the IQR box, and a note that width approximates frequency." fig-align="center" width="75%"}

| Component | Meaning |
|---|---|
| Width of the violin | Density of data at that value (KDE) |
| White dot (center) | Median |
| Thick black bar | Interquartile range (IQR): Q1 to Q3 |
| Thin whisker lines | Data range within 1.5 × IQR |
| Points beyond whiskers | Outliers (when shown) |

---

## Creating Violin Plots in Python

### Setup

```python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Reproducible example
rng = np.random.default_rng(42)
```

### Example 1: A Basic Violin Plot with Seaborn

We will simulate gene expression values across three tissue types — a common scenario in bioinformatics.

```python
# Simulate gene expression data (log2 TPM values)
n = 200
data = pd.DataFrame({
    "expression": np.concatenate([
        rng.normal(loc=5.0, scale=1.2, size=n),   # Tissue A: normal distribution
        rng.normal(loc=6.5, scale=0.8, size=n),   # Tissue B: higher, tighter
        np.concatenate([                           # Tissue C: bimodal
            rng.normal(loc=3.5, scale=0.6, size=n // 2),
            rng.normal(loc=7.0, scale=0.6, size=n // 2),
        ]),
    ]),
    "tissue": (["Tissue A"] * n) + (["Tissue B"] * n) + (["Tissue C"] * n),
})

fig, ax = plt.subplots(figsize=(8, 5))

sns.violinplot(
    data=data,
    x="tissue",
    y="expression",
    inner="box",        # Show box plot summary inside
    palette="muted",
    ax=ax,
)

ax.set_title("Gene Expression by Tissue Type", fontsize=14)
ax.set_xlabel("Tissue")
ax.set_ylabel("Expression (log2 TPM)")
plt.tight_layout()
plt.savefig("violin_basic.png", dpi=150)
plt.show()
```

The `inner="box"` argument overlays a mini box plot inside the violin, so you get both the full distribution shape and the quartile summary.

---

### Example 2: Split Violin Plot for Two-Group Comparisons

A **split violin** is ideal when you want to compare two conditions side by side within each category (e.g., treated vs. control).

```python
# Add a condition variable
data["condition"] = np.tile(
    ["Control"] * (n // 2) + ["Treated"] * (n // 2), 3
)

fig, ax = plt.subplots(figsize=(9, 5))

sns.violinplot(
    data=data,
    x="tissue",
    y="expression",
    hue="condition",
    split=True,         # Left half = one group, right half = other
    inner="quart",      # Show quartile lines instead of box
    palette={"Control": "#4C72B0", "Treated": "#DD8452"},
    ax=ax,
)

ax.set_title("Expression by Tissue and Condition (Split Violin)", fontsize=14)
ax.set_xlabel("Tissue")
ax.set_ylabel("Expression (log2 TPM)")
ax.legend(title="Condition", loc="upper left")
plt.tight_layout()
plt.savefig("violin_split.png", dpi=150)
plt.show()
```

In a split violin:
- The **left half** shows one group's distribution
- The **right half** shows the other group's distribution
- The width comparison between the two halves immediately shows where the distributions differ

---

### Example 3: Violin + Strip Plot (Showing Raw Data)

For smaller datasets (under ~500 points per group), overlaying individual data points adds transparency and removes the "black box" concern with pure summaries.

```python
small_data = data.sample(n=60, random_state=42)   # Subset for visibility

fig, ax = plt.subplots(figsize=(8, 5))

sns.violinplot(
    data=small_data,
    x="tissue",
    y="expression",
    inner=None,         # No inner summary — we will add points instead
    palette="pastel",
    ax=ax,
)

sns.stripplot(
    data=small_data,
    x="tissue",
    y="expression",
    color="black",
    alpha=0.5,
    size=4,
    jitter=True,        # Spread points horizontally to avoid overlap
    ax=ax,
)

ax.set_title("Expression Distribution with Individual Points", fontsize=14)
ax.set_xlabel("Tissue")
ax.set_ylabel("Expression (log2 TPM)")
plt.tight_layout()
plt.savefig("violin_strip.png", dpi=150)
plt.show()
```

This combination — violin for the shape, strip for the individual observations — is highly recommended in scientific publications because it is both honest and informative.

---

## Creating Violin Plots in R

### Setup

```r
library(ggplot2)
library(dplyr)

set.seed(42)
```

### Simulating the Data

```r
n <- 200

data <- bind_rows(
  tibble(
    expression = rnorm(n, mean = 5.0, sd = 1.2),
    tissue = "Tissue A"
  ),
  tibble(
    expression = rnorm(n, mean = 6.5, sd = 0.8),
    tissue = "Tissue B"
  ),
  tibble(
    expression = c(rnorm(n / 2, mean = 3.5, sd = 0.6),
                   rnorm(n / 2, mean = 7.0, sd = 0.6)),
    tissue = "Tissue C"
  )
)
```

### Basic Violin Plot with ggplot2

```r
ggplot(data, aes(x = tissue, y = expression, fill = tissue)) +
  geom_violin(trim = FALSE, alpha = 0.7) +
  geom_boxplot(width = 0.1, fill = "white", outlier.shape = NA) +
  scale_fill_brewer(palette = "Set2") +
  labs(
    title = "Gene Expression by Tissue Type",
    x = "Tissue",
    y = "Expression (log2 TPM)"
  ) +
  theme_classic() +
  theme(legend.position = "none")
```

The `trim = FALSE` argument keeps the tails of the KDE extended to the true data range. Setting `trim = TRUE` (the default in some versions) cuts them off at the data extremes.

### Adding Individual Points

```r
ggplot(data, aes(x = tissue, y = expression, fill = tissue)) +
  geom_violin(trim = FALSE, alpha = 0.6) +
  geom_jitter(width = 0.1, size = 0.8, alpha = 0.4) +
  scale_fill_brewer(palette = "Pastel1") +
  labs(
    title = "Expression with Jittered Data Points",
    x = "Tissue",
    y = "Expression (log2 TPM)"
  ) +
  theme_minimal() +
  theme(legend.position = "none")
```

---

## How to Interpret a Violin Plot

Once you have your plot, here is a systematic way to read it.

### 1. Look at Width — Where Are Values Concentrated?

The wider the violin at a given value on the y-axis, the more data points fall near that value. A violin that is fat in the middle has most data near the median. A violin that is fat near the top indicates a right-skewed (or heavy upper tail) distribution.

### 2. Check for Multiple Bumps — Is It Bimodal?

A violin with two distinct bulges suggests a **bimodal distribution**: two subpopulations with different typical values. This is a crucial insight that a box plot would completely hide. In genomics, this can indicate a mixture of cell types, two biological states, or batch effects.

In the example above, **Tissue C** is simulated as bimodal — one subpopulation with low expression (~3.5) and another with high expression (~7.0). A box plot of Tissue C would show a wide IQR and a median around 5, giving no hint that values cluster at two separate points.

### 3. Assess Symmetry — Is the Distribution Skewed?

| Shape | Interpretation |
|---|---|
| Fat in the middle, tapers evenly at both ends | Symmetric / approximately normal |
| Wider at the top, narrow at the bottom | Right-skewed (positive skew) — most values are low but a few are very high |
| Wider at the bottom, narrow at the top | Left-skewed (negative skew) — most values are high but a few are very low |

### 4. Compare Medians and Spreads Across Groups

The white dot (or inner line) in each violin marks the **median**. To compare groups:

- If the median line of one violin is clearly higher, that group tends to have higher values.
- If one violin is much narrower than another, that group is more consistent (lower variance).
- If one violin is much wider than another, that group shows more variability.

### 5. Tail Length — Are There Extremes?

A violin with a long thin tail at the top or bottom indicates rare but extreme values. In a box plot those would be marked as outliers; in a violin they appear as the faint tapered ends of the KDE.

---

## Common Pitfalls and How to Avoid Them

### Pitfall 1: KDE Bandwidth Matters

The violin shape depends on the **bandwidth** used for the kernel density estimate. A bandwidth that is too large will over-smooth and hide real features (like bimodality). A bandwidth that is too small will produce a noisy, spiky violin with artefactual bumps.

**Seaborn** uses Scott's rule by default; you can override it:

```python
sns.violinplot(data=data, x="tissue", y="expression", bw=0.5)
# bw controls the KDE bandwidth — lower = more detail, higher = smoother
```

**ggplot2** also uses a default bandwidth; adjust with `bw` inside `geom_violin()`:

```r
geom_violin(trim = FALSE, bw = 0.3)  # Narrower bandwidth = more detail
```

Always test a few bandwidth values to confirm the shape you see is real, not an artifact of the smoothing.

---

### Pitfall 2: Violin Plots Need Enough Data

A violin plot is a density estimate. With fewer than ~30 observations per group, the KDE shape becomes unreliable. For small samples:

- Use a **box plot** or **dotplot** instead.
- Or overlay raw points (strip/jitter) and skip the violin entirely.

---

### Pitfall 3: Violins Can Extend Beyond Impossible Values

KDE can produce probability mass outside the actual data range. For example, if your data represents a count (minimum = 0), the violin may show a tail below zero.

Fix in seaborn:

```python
sns.violinplot(data=data, x="tissue", y="expression", cut=0)
# cut=0 clips the violin at the observed data range
```

Fix in ggplot2:

```r
geom_violin(trim = TRUE)  # Trim the tails to the data range
```

---

## Summary

| Question | What to look for |
|---|---|
| Where are most values? | The widest part of the violin |
| What is the typical value? | The white dot (median) |
| How consistent is the data? | Narrow violin = low variance; wide violin = high variance |
| Are there two groups mixed together? | Two bumps = bimodal distribution |
| Is the distribution skewed? | Unequal tail lengths |
| Are there extreme outliers? | Long, thin tails |

Violin plots reward the viewer who takes time to look past the summary statistics. The shape tells a story that a mean and standard deviation cannot — and in biology, that shape often reveals the most interesting biology.

---

## Further Reading

- Hintze, J. L., & Nelson, R. D. (1998). Violin plots: A box plot–density trace synergism. *The American Statistician*, 52(2), 181–184.
- Seaborn documentation: [violinplot](https://seaborn.pydata.org/generated/seaborn.violinplot.html)
- ggplot2 documentation: [geom_violin](https://ggplot2.tidyverse.org/reference/geom_violin.html)
